# Решение

В это сложно поверить, но это действительно файлообменник, куда можно загружать файлы. И этот файлообменник явно основан
на Uguu.se с минимальными изменениями (фотки серого кота вместо тянок)

Если такой проект реально существует и достаточно популярен, то в нем точно нет уязвимостей... верно?

Но у наших горе-разработчиков есть талант - ломать, не прикасаясь, и это дает нам шанс.

### 1. Придумываем вектор атаки

Страничка очень простая и надеяться на скрытое веб-приложение или админ-панель будет глупо. А значит сосредоточимся на
основном и единственном функионале сайта - загружать файлы. Попытавшись загрузить некоторые типы файлов, мы понимаем,
что где-то в коде есть черный список расширений. Кстати вот он, ничем не отличается от оригинального:
```php
[
    "exe",
    "scr",
    "com",
    "vbs",
    "bat",
    "cmd",
    "htm",
    "html",
    "jar",
    "msi",
    "apk",
    "phtml",
    "svg",
    "php"
  ]
```

Однако, в отличие от белого списка, черный список содержит только то, до чего додумался разработчик. А мог ли он забыть
о чем-нибудь?

Итак, наша задача - залить `.php` файл, который сможет выполнять наши команды на сервере, то есть шелл. Но расширение 
`.php` находится в черном списке. Что делать? Вбивать в гугл `php extension filter bypass` - получаем
[сайт](https://book.hacktricks.xyz/pentesting-web/file-upload) со списком расширений, которые обычно используются
для PHP-скриптов

### 2. RCE

Попробовав большинство вариантов, выясняется что сервер очень спокойно выполняет `.php5` и `.php7` файлы. Теперь можно 
загрузить какой-нибудь [удобный](https://github.com/flozz/p0wny-shell) шелл и посмотреть содержимое сервера.

В итоге в `/var/www/flag.txt` находим флаг
```bash
$ cat /var/www/flag.txt
vrnctf{BL4CKLIST_1SSUE_I_GUESS}
```